!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){e.getRandomNumber=function(){return 60*Math.random()-30},e.getNumberIn=function(t,e){return t+(e-t)*Math.random()}},function(t,e,n){"use strict";n.r(e);var r=n(0);function o(t,e){var n=this;this.n_rows=t,this.n_cols=e,this.data=new Array(t),this.data.fill(1,0,t),this.data=this.data.map((function(t){return new Array(e)})),this.data=this.data.map((function(t){return t.fill(1,0,e).map((function(t){return Object(r.getNumberIn)(-2,2)}))})),this.copyColumn=function(t,e){if(!(n.n_rows===t.n_rows&&e<t.n_cols))throw new Error("Matrix should have n_rows for copying a column");for(var r=0;r<t.n_rows;r++)n.data[r][e]=t.data[r][e]}}function i(t,e){for(var n=new o(t.n_rows,t.n_cols),r=0;r<t.n_rows;r++)for(var i=0;i<t.n_cols;i++)n.data[r][i]=e*t.data[r][i];return n}function a(t,e){if(t.n_rows!==e.n_rows||t.n_cols!==e.n_cols)throw new Error("Matrix dimentions dont match for addition");for(var n=t.data,r=e.data,i=new o(t.n_rows,t.n_cols),a=0;a<t.n_rows;a++)for(var u=0;u<t.n_cols;u++)i.data[a][u]=n[a][u]+r[a][u];return i}function u(t,e,n){this.size=t,this.outputSize=e,this.activation=n,this.weights=new o(e,t),this.bias=new o(e,1),this.activation=n,this.compute=function(t){var e=function(t,e){var n=t.data,r=e.data;if(t.n_cols!==e.n_rows)throw new Error("Matrix dimensions dont match for multiplication.");for(var i=new o(t.n_rows,e.n_cols),a=0;a<t.n_rows;a++)for(var u=0;u<e.n_cols;u++){for(var c=0,s=0;s<t.n_cols;s++)c+=n[a][s]*r[s][u];i.data[a][u]=c}return i}(this.weights,t);return this.activation(a(e,this.bias))}}function c(t){for(var e=new o(t.n_rows,t.n_cols),n=0;n<t.n_rows;n++)for(var r=0;r<t.n_cols;r++)e.data[n][r]=Math.max(0,t.data[n][r]);return e}function s(t){for(var e=new o(t.n_rows,t.n_cols),n=0;n<t.n_rows;n++)for(var r=0;r<t.n_cols;r++)e.data[n][r]=1/(1+Math.exp(-t.data[n][r]));return e}function l(t){this.layers=t,this.feedFoward=function(t){return this.layers.reduce((function(t,e){return e.compute(t)}),t)}}function f(t){var e=this;this.representation=t,this.fitScore=0,this.setFitness=function(t){e.fitScore=t},this.mate=function(t){for(var n=e.representation,o=t.representation,c=e.representation.layers.length,s=[],p=0;p<c;p++){for(var h=n.layers[p],d=o.layers[p],v=new u(h.size,h.outputSize,h.activation),w=0,y=0,b=0;b<h.size;b++){var g=Math.random();if(g<.45)v.weights.copyColumn(h.weights,b),w+=1;else if(g<.9)v.weights.copyColumn(d.weights,b),y+=1;else for(var m=v.weights.data,_=0;_<m.length;_++)m[_][b]=.25*h.weights.data[_][b]+.25*d.weights.data[_][b]+.5*Object(r.getNumberIn)(-50,50)}v.bias=a(i(h.bias,w/(w+y)),i(d.bias,y/(w+y))),s.push(v)}return new f(new l(s))}}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=document.getElementById("canvas").getContext("2d");function v(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return n+Object(r.getNumberIn)(.1,.5)*e}d.fillStyle="green",d.fillRect(0,0,30,30);var w=60,y=new Array(w).fill(0,0,w),b=0;var g=new Array(w).fill(1,0,w).map((function(t){return new f(new l([new u(4,5,s),new u(5,12,c),new u(12,1,s)]))}));!function t(e){var n=e.populationSize,r=new Array(n).fill({x:100,y:225,vy:0},0,n);r=r.map((function(t,e){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,{y:t.y-e})}));var i=[{x:900,center:v(150,450)},{x:1350,center:v(150,450)}],a=0,u=setInterval((function(){var n=function(t,e){return t.map((function(t){if(t.dead)return!0;if(t.y-20<=0)return!0;if(t.y+20>=450)return!0;var n=e[0];return t.x+20>=n.x&&t.x-20<=n.x+55&&(t.y-20<=n.center-75||t.y+20>=n.center+75)}))}(r,i);if((y=y.map((function(t,e){return 0===t&&n[e]?(r[e].dead=!0,a):t}))).reduce((function(t,e){return t&&e}),1))return clearInterval(u),!0,console.log("Geneation #"+b,y),e.runIteration(y,b++),y.fill(0,0,w),void t(e);d.clearRect(0,0,canvas.width,canvas.height);var c=[];r.forEach((function(t,n){if(t.dead)t.x+=-1;else{t.vy+=.1,t.y+=t.vy;var r=i[0].x-t.x,a=new o(4,1);a.data=[[Math.max(0,r)],[t.y],[.05*t.vy],[i[0].center-t.y]];var u=e.population[n].representation.feedFoward(a);c.push(u.data[0][0]),(u=u.data[0][0])<.5&&(t.vy=-4)}})),(i=i.map((function(t){return{x:t.x+=-1,center:t.center}})))[0].x+55<=0&&(i.splice(0,1),i.push({x:927.5,center:v(150,450)}),a+=2e3),i.forEach((function(t){d.fillStyle="green",d.fillRect(t.x,0,55,t.center-75),d.fillRect(t.x,t.center+75,55,450-t.center)})),d.beginPath(),r.forEach((function(t){var e,n,r;e=t.x,n=t.y,r=20,d.moveTo(e+r,n),d.arc(e,n,r,0,2*Math.PI)})),d.closePath(),d.fillStyle="rgba(193, 35, 35, 0.5)",d.strokeStyle="#003300",d.fill(),d.stroke(),a++}),10)}(new function t(e,n,o,i){var a,u,c,s=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c=function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],s.population.forEach((function(e,n){return e.setFitness(t[n])})),s.population=s.population.sort((function(t,e){return t.fitScore<e.fitScore?-1:(t.fitScore,e.fitScore,1)})),console.log("Best solution is : ",s.population[s.populationSize-1]),s.population[s.populationSize-1].fitScore>s.target)console.log("Best solution is : ",s.population[s.populationSize-1]);else{for(var e=[],n=s.populationSize-1;e.length<=s.ellitism*s.populationSize;n--)e.push(s.population[n]);for(var o=e.length;o<s.populationSize;o=e.length){Math.floor(Object(r.getNumberIn)(.5*s.populationSize,s.populationSize));var i=Math.floor(Object(r.getNumberIn)(.5*s.populationSize,s.populationSize)),a=s.population[s.populationSize-1].mate(s.population[i]);e.push(a)}s.population=e}},(u="runIteration")in(a=this)?Object.defineProperty(a,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[u]=c,this.populationSize=e,this.population=n,this.ellitism=o,this.target=i}(w,g,.2,3e5))}]);